<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Steplists</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Steplists</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(epicmodel)</span></code></pre></div>
<div id="input-for-scc-model-creation" class="section level1">
<h1>Input for SCC model creation</h1>
<p><strong>Sufficient-component cause (SCC) models</strong> consist of
component causes, which are grouped to sufficient causes. Sufficient
causes are minimally sufficient for the outcome of interest to occur,
i.e., if only one of the component causes included is missing, the
outcome does not occur (at least not via this sufficient cause).</p>
<p>The <strong>main modeling task</strong> when creating SCC models is
therefore to specify, which component causes belong into the same
sufficient cause. Since SCC models are causal models, these
specifications need to be based on knowledge regarding the mechanisms of
outcome occurrence and not statistical knowledge, i.e., based on the
mechanisms of outcome occurrence it needs to be specified how component
causes are connected with each other and with the outcome.</p>
<p>Because sufficient causes are minimally sufficient, it is necessary
to also describe minimally sufficient mechanisms that connect them. For
this reason, the complex net of mechanisms leading to outcome occurrence
needs to be split into small parts. These small parts are called
<strong>steps</strong> in <code>epicmodel</code>. Component causes are
linked with each other and the outcome of interest by
<strong>chaining</strong> these steps together.</p>
</div>
<div id="step-structure" class="section level1">
<h1>Step structure</h1>
<p>Steps have a <strong>pre-defined structure</strong> to facilitate
chaining. The developed structure tries to strike the balance between
flexible and user-friendly step specification and automated SCC model
creation. The structure used in <code>epicmodel</code> is basically an
IF-THEN structure. Steps consists of 3 parts:</p>
<ul>
<li>IF condition</li>
<li>IFNOT condition</li>
<li>THEN statement</li>
</ul>
<div id="then-statements" class="section level2">
<h2>THEN statements</h2>
<p>THEN statements are the core building block of steps. They describe
what happens, e.g., Cell A releases cytokine B, Exposure to C, D moves
to E, etc. In order to facilitate chaining of steps, THEN statements
also follow a <strong>pre-defined structure</strong>. This makes it
possible to automatically create ID and description for THEN statements.
IDs are then used for chaining. As steps are built from THEN statements,
this structure also enables automated creation of step IDs and
descriptions.</p>
<p>THEN statements contain <strong>up to 4 segments</strong>:</p>
<ul>
<li>WHAT segment (Subject)</li>
<li>DOES segment</li>
<li>WHAT segment or THEN statement (Object)</li>
<li>WHERE segment</li>
</ul>
<p>THEN statements follow a <code>WHAT DOES WHAT WHERE</code> structure
and therefore generally consist of <strong>WHAT, DOES, and WHERE
segments</strong>. WHAT segments can appear twice: the first is called
<strong>“subject”</strong>, the second is called
<strong>“object”</strong>. Here you can see how the examples above fit
into the <code>WHAT DOES WHAT WHERE</code> structure:</p>
<p><strong>Cell A releases cytokine B</strong></p>
<ul>
<li>WHAT: Cell A</li>
<li>DOES: releases</li>
<li>WHAT: cytokine B</li>
<li>WHERE: -</li>
</ul>
<p><strong>Exposure to C</strong></p>
<ul>
<li>WHAT: -</li>
<li>DOES: Exposure to</li>
<li>WHAT: C</li>
<li>WHERE: -</li>
</ul>
<p><strong>D moves to E</strong></p>
<ul>
<li>WHAT: D</li>
<li>DOES: moves</li>
<li>WHAT: -</li>
<li>WHERE: to E</li>
</ul>
<p>Some DOES segments require the <strong>object to be a THEN
statement</strong> instead of a WHAT segment. Imagine, e.g., the DOES
segment “inhibition”. In general, inhibition can be modeled by
specifying IFNOT conditions (see below). However, if inhibition only
occurs under certain condition, it might need to be specified as its own
step. Since only a certain process, i.e., a specific step is inhibited,
the object in these cases needs to be this exact step. There might be
other DOES segments, for which THEN objects are necessary. The option to
use THEN objects offers more flexibility to model the mechanisms found
in Nature within the <code>WHAT DOES WHAT WHERE</code> structure. Note
that a certain DOES segment either has WHAT or THEN objects in all its
steps. Please also note that THEN objects can be “stacked” by including
as object a THEN statement that already has a THEN object. In general,
WHAT object should be far more prevalent though. (That’s why we
generally refer to the structure as <code>WHAT DOES WHAT WHERE</code>
structure.)</p>
<p>A THEN statement can contain up to 4 segments, but it <strong>does
not have to</strong>. In general, all combinations of segments are
possible and you, the modeler, need to decide how to model the process
of interest. The <code>WHAT DOES WHAT WHERE</code> structure is supposed
to facilitate automation of naming and SCC creation, but also grant as
much flexibility as needed to model all necessary processes. Remember
that the goal is to connect component causes with each other and the
outcome of interest in order to enable grouping of component causes to
sufficient causes. The structure is designed with this goal in mind. So
far, in our projects, we were able to model all processes within this
structure, but if you encounter something you cannot model, let us know
on GitHub and we adjust the structure accordingly. Please also note
that, although all segment combinations are possible in theory, only
DOES, only WHERE, and WHAT-WHAT, in our experience, do not make much
sense.</p>
</div>
<div id="if-and-ifnot-conditions" class="section level2">
<h2>IF and IFNOT conditions</h2>
<p>IF and IFNOT describe the conditions for the THEN statement to occur.
The IF condition must be fulfilled in order for the THEN statement to
occur. The IFNOT condition must <strong>not</strong> be fulfilled in
order for the THEN statement to occur. IF and IFNOT themselves are a
combination of THEN statements combined with AND/OR logic. By using THEN
statements in IF and IFNOT conditions, the individual step can be
chained together.</p>
<p>When creating a step, specification of the THEN statement is
mandatory while IF and IFNOT conditions are optional. If the IF
condition is missing, there is no pre-condition and the THEN statement
“just happens”. Therefore, this type of steps are <strong>“starting
steps”</strong> and their description begins with <code>Start:</code>.
They form the start of the chains that connect the component causes and
the outcome of interest. In our context, “starting steps” usually
represent component causes. In reality, component causes are, of course,
caused by other factors not otherwise involved in causing the outcome,
e.g., an occupational exposure that causes occupational asthma is caused
by socio-economic factors that influence job choice. But in the context
of SCC model creation when our task is to group the component causes to
sufficient causes, component causes are the starting point and therefore
represented by steps without IF condition. However, please note that
component causes can have IFNOT conditions.</p>
<p>Here are the step descriptions from the built-in steplist
<code>steplist_rain</code> as an example:</p>
<ul>
<li>Start: IFNOT take vacation THEN no vacation</li>
<li>Start: weekday</li>
<li>Start: rain</li>
<li>Start: get groceries</li>
<li>Start: take umbrella</li>
<li>Start: work from home</li>
<li>Start: take vacation</li>
<li>IF no vacation and weekday and IFNOT work from home THEN walk to
work</li>
<li>IF get groceries or walk to work THEN go outside</li>
<li>End: IF go outside and rain and IFNOT take umbrella THEN you get
wet</li>
</ul>
</div>
</div>
<div id="step-types" class="section level1">
<h1>Step types</h1>
<p>There are, as mentioned, different types of steps that play different
roles during SCC model creation:</p>
<p>Based on the presence of an IF condition, we define:</p>
<ul>
<li><strong>Starting steps</strong>: Steps without IF condition</li>
<li><strong>Non-starting steps</strong>: Steps with IF condition</li>
</ul>
<p>Starting steps can also be separated into two types:</p>
<ul>
<li><strong>Component causes</strong>: Starting steps which appear in IF
conditions of other steps (and maybe additionally in IFNOT conditions of
other steps)</li>
<li><strong>Interventions</strong>: Starting steps which do
<strong>not</strong> appear in IF conditions of other steps but only in
IFNOT conditions of other steps</li>
</ul>
<p>Therefore, component causes, interventions, and non-starting steps
are mutually exclusive and together form the complete list of steps.</p>
<p>In addition, we define:</p>
<ul>
<li><strong>IFNOT steps</strong>: Steps with IFNOT condition, including
starting steps with IFNOT condition</li>
<li><strong>End steps</strong>: Steps that appear in outcome
definitions</li>
</ul>
</div>
<div id="steplist" class="section level1">
<h1>Steplist</h1>
<p>The steplist is the structure that contains all specified steps. It
is the only input for function <code>create_scc()</code>, which creates
the SCC model. See <code>?new_steplist</code> for a detailed description
of the structure of steplists from a R perspective.</p>
<div id="additional-step-attributes" class="section level2">
<h2>Additional step attributes</h2>
<p>Steps contain additional attributes:</p>
<ul>
<li>Module: Modules are groups to which steps are assigned. If modules
are used, every step is in exactly one module.</li>
<li>End step indicator: Indicates if a certain step is part of the
outcome definition</li>
<li>Note: Additional notes, e.g., regarding the level of evidence,
etc.</li>
<li>Reference: Since we model our steps based on the literature, every
step should have at least one reference</li>
</ul>
</div>
<div id="steplist-elements" class="section level2">
<h2>Steplist elements</h2>
<p>In R, steplists are defined as S3 class and contain 8 data.frames.
Here’s a short overview, but also see <code>?new_steplist</code> for
details.</p>
<ul>
<li>WHAT: Contains WHAT segments</li>
<li>DOES: Contains DOES segments</li>
<li>WHERE: Contains WHERE segments</li>
<li>THEN: Contains THEN statements</li>
<li>Module: Contains the list of modules</li>
<li>Step: Contains the list of steps</li>
<li>ICC: Short for <code>incompatible component causes</code> and
records combinations of component causes, which cannot appear in
practice. Sets of component causes which contain ICCs are not considered
during SCC model creation.</li>
<li>Outc: Short for <code>outcome definition</code>, which is a list of
conditions under which the outcome is assumed to have occurred. In
practice, the outcome definition consists of end steps combined by
AND/OR logic.</li>
</ul>
</div>
</div>
<div id="steplist-creation" class="section level1">
<h1>Steplist creation</h1>
<p>Steplists are created with the built-in <strong>Steplist Creator
<code>Shiny</code> App</strong>. It can be launched with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">launch_steplist_creator</span>()</span></code></pre></div>
<p>We made a little tutorial that shows how to use the
<code>shiny</code> app, see
<code>vignette(&quot;articles/steplist_creator_tutorial&quot;)</code>. It contains
screenshots and an example for you to click along. Please note that the
tutorial is not shipped with the package and can only be accessed on the
homepage.</p>
</div>
<div id="processing-steplists-in-r" class="section level1">
<h1>Processing steplists in R</h1>
<p>The steplist created in the <code>shiny</code> app can be downloaded
as <code>.rds</code> file and loaded into R using
<code>readRDS()</code>. Additionally, there are some options to process
the steplist in R, as it might be easier for some standard tasks instead
of clicking through the app. These functions accompany
<code>check_steplist()</code>, so let’s talk about this function
first.</p>
<div id="checked-and-unchecked-steplists" class="section level2">
<h2>Checked and unchecked steplists</h2>
<p>A steplist needs to fulfill additional structural requirements in
order to be used in <code>create_scc()</code>. These requirements are
checked with <code>check_steplist()</code>. The function documentation
contains a detailed description of conducted checks. Some violation will
result in errors, which means that checking was not successful and you
need to make changes. Other violations will only result in warnings,
which suggest some non-mandatory changes. If
<code>check_steplist()</code> only results in warnings, you will still
get a checked steplist. Let’s look at the built-in
<code>steplist_party</code> as an example.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>steplist <span class="ot">&lt;-</span> steplist_party</span></code></pre></div>
<p>Now, let’s run <code>check_steplist()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>steplist_checked <span class="ot">&lt;-</span> <span class="fu">check_steplist</span>(steplist)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; ── Checking epicmodel_steplist steplist ──────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; ✔ Checking WHAT IDs was successful.</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; ✔ Checking DOES IDs was successful.</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; ✔ Checking WHERE IDs was successful.</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; ✔ Checking Module IDs was successful.</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; ✔ Checking ICC IDs was successful.</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; ✔ Checking WHAT keywords was successful.</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; ✔ Checking DOES keywords was successful.</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; ✔ Checking WHERE keywords was successful.</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; ✔ Checking Module keywords was successful.</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; ✔ Checking Modules was successful.</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; ✖ Checking ICC entries failed!</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Caused by error in `check_steps_in_icc()`:</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; ! All IDs in data.frame `icc`, i.e. in variables `id1` and `id2`, must be in `id_step` of data.frame `step`!</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; ℹ Data.frame `icc` contains 4 elements with two step IDs each.</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; ✖ In total, 1 ID is not in data.frame `step`: NA</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; ℹ If only `NA` is not in data.frame `step`, use `steplist &lt;- remove_na(steplist)`.</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; ✔ Checking WHAT segments was successful.</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; ! Checking DOES segments resulted in warnings!</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; ! Not all DOES segments have been used in data.frame `step`!</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; ℹ Data.frame `does` contains 6 elements.</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; ℹ In total, 1 DOES segment is not being used in data.frame `step`: d4</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; ✔ Checking WHERE segments was successful.</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; ! Checking references resulted in warnings!</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; ! For some steps no references have been provided!</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; ℹ In total, 16 steps have no references.</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; ✔ Checking start/end steps was successful.</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; ✔ Checking THEN statements was successful.</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; ✔ Checking THEN/IF/IFNOT equality was successful.</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; ✔ Checking outcome definitions was successful.</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt; ── Summary ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt; ✖ Checking failed! Please correct errors and repeat.</span></span></code></pre></div>
<p>You can see that many checks have been successful but also that some
of them resulted in errors or warnings. The first error tells you that
“Checking ICC entries failed!”. As a reminder, ICC is short for
incompatible component causes and it tells you that in the
<code>ICC</code> data.frame of the steplist, you used step IDs that have
not been defined, i.e., cannot be found in data.frame <code>step</code>
of the steplist. It gives more details: “In total, 1 ID is not in
data.frame <code>step</code>: NA”. This clarifies a lot: There is still
an entry in the table that contains NA, which is counted as an empty
element. Luckily, in this case, it offers a solution: using
<code>remove_na()</code>. Next, we have the warning “Not all DOES
segments have been used in data.frame <code>step</code>!” As it tells us
two lines below, we specified <code>d4</code> in data.frame
<code>does</code> but did not use it when creating steps. Even though
this won’t break SCC model creation, let’s also address it. Finally,
<code>check_steplist()</code> warns us that “For some steps no
references have been provided!”. Because steps are usually based on the
literature, <code>epicmodel</code> will not get tired of telling you to
specify references in the steplist! In summary, checking failed, which
we can verify by printing <code>steplist_checked</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">print</span>(steplist_checked)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; ✖ unchecked (please run `check_steplist()` before continuing)</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; WHAT:  9  WHAT segments</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; DOES:  6  DOES segments</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; WHERE:  6  WHERE segments</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; MODULE:  3  modules</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; STEP:  16  STEPs</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; ICC:  4  incompatible component-cause pairs</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; OUTCOME:  1  outcome definition</span></span></code></pre></div>
<p>The first line shows us that <code>steplist_checked</code> is still
“unchecked”. So, let’s work on those errors and warnings. First, to
remove the NAs from data.frame <code>icc</code>, let’s run
<code>remove_na()</code>. It removes rows that only consist of NAs from
data.frames <code>icc</code> as well as <code>outc</code>, which
contains the outcome definition. Next, we can delete DOES segment
<code>d4</code> with function <code>remove_segment()</code>, which
allows you to delete a single entry from data.frames <code>what</code>,
<code>does</code>, <code>where</code>, <code>module</code>, and
<code>icc</code> by specifying its ID.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>steplist <span class="ot">&lt;-</span> <span class="fu">remove_na</span>(steplist)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>steplist <span class="ot">&lt;-</span> <span class="fu">remove_segment</span>(steplist, <span class="st">&quot;d4&quot;</span>)</span></code></pre></div>
<p>This time, <code>check_steplist()</code> is successful. Since our
example is about a party, we ignore the warning about references.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>steplist_checked <span class="ot">&lt;-</span> <span class="fu">check_steplist</span>(steplist)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># ── Checking epicmodel_steplist steplist ───────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># ✔ Checking WHAT IDs was successful.</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># ✔ Checking DOES IDs was successful.</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># ✔ Checking WHERE IDs was successful.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># ✔ Checking Module IDs was successful.</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># ✔ Checking ICC IDs was successful.</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># ✔ Checking WHAT keywords was successful.</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># ✔ Checking DOES keywords was successful.</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co"># ✔ Checking WHERE keywords was successful.</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># ✔ Checking Module keywords was successful.</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co"># ✔ Checking Modules was successful.</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co"># ✔ Checking ICC entries was successful.</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># ✔ Checking WHAT segments was successful.</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># ✔ Checking DOES segments was successful.</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co"># ✔ Checking WHERE segments was successful.</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co"># ! Checking references resulted in warnings!</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co"># Caused by warning:</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co"># ! For some steps no references have been provided!</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co"># ℹ In total, 16 steps have no references.</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co"># ✔ Checking start/end steps was successful.</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co"># ✔ Checking THEN statements was successful.</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co"># ✔ Checking THEN/IF/IFNOT equality was successful.</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co"># ✔ Checking outcome definitions was successful.</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co"># ── Summary ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co"># ✔ Checking successful!</span></span></code></pre></div>
<p>Printing <code>steplist_checked</code> confirms that checking was
successful.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">print</span>(steplist_checked)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; ✔ checked successfully</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; WHAT:  9  WHAT segments</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; DOES:  5  DOES segments</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; WHERE:  6  WHERE segments</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; MODULE:  3  modules</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; STEP:  16  STEPs</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; ICC:  3  incompatible component-cause pairs</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; OUTCOME:  1  outcome definition</span></span></code></pre></div>
<p>There is another function available for processing steplists in R.
It’s called <code>remove_all_modules()</code> and, as the name implies,
it removes all modules from data.frame <code>module</code> and deletes
assigned modules in data.frame <code>step</code>. <code>epicmodel</code>
expects that either all steps or none of them have a module specified.
With <code>remove_all_modules()</code>, you have an easy tool for
choosing the second option.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>steplist_checked <span class="ot">&lt;-</span> <span class="fu">remove_all_modules</span>(steplist_checked)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; ! Changing the steplist makes it necessary to repeat `check_steplist()`!</span></span></code></pre></div>
<p>We already get a warning that we need to repeat
<code>check_steplist()</code>. Let’s print <code>steplist_checked</code>
to investigate.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">print</span>(steplist_checked)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; ✖ unchecked (please run `check_steplist()` before continuing)</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; WHAT:  9  WHAT segments</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; DOES:  5  DOES segments</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; WHERE:  6  WHERE segments</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; MODULE:  0  modules</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; STEP:  16  STEPs</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; ICC:  3  incompatible component-cause pairs</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; OUTCOME:  1  outcome definition</span></span></code></pre></div>
<p>Indeed, we see that <code>steplist_checked</code> has 0 modules now
but is “unchecked” again. In fact, <code>remove_na()</code> and
<code>remove_segment()</code> also “uncheck” a previously checked
steplist. Additionally, all steplists you download from the
<code>shiny</code> app are “unchecked” as well, even if you uploaded a
“checked” steplist.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
